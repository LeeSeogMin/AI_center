# 한신대학교 AI 정책연구소 홈페이지 재현 가이드

이 문서는 한신대학교 AI 정책연구소 웹사이트 프로젝트를 처음부터 재현하기 위한 완전한 가이드입니다.

---

## 목차

1. [프로젝트 개요](#1-프로젝트-개요)
2. [사전 준비사항](#2-사전-준비사항)
3. [Supabase 프로젝트 생성 및 설정](#3-supabase-프로젝트-생성-및-설정)
4. [데이터베이스 스키마 구축](#4-데이터베이스-스키마-구축)
5. [인증(Authentication) 설정](#5-인증authentication-설정)
6. [Next.js 프로젝트 설정](#6-nextjs-프로젝트-설정)
7. [환경 변수 설정](#7-환경-변수-설정)
8. [Supabase 클라이언트 구성](#8-supabase-클라이언트-구성)
9. [게시판 기능 구현](#9-게시판-기능-구현)
10. [Vercel 배포](#10-vercel-배포)
11. [테스트 및 확인](#11-테스트-및-확인)

---

## 1. 프로젝트 개요

### 기술 스택
- **Frontend**: Next.js 14.2.35 (App Router)
- **UI Framework**: React 18.3.1
- **Styling**: Tailwind CSS 3.4.19
- **Backend/Database**: Supabase (PostgreSQL)
- **Authentication**: Supabase Auth (Email, Google OAuth)
- **Deployment**: Vercel
- **Language**: TypeScript 5.9.3

### 주요 기능
- 연구소 소개 페이지
- 게시판 시스템 (공지사항, 자료실, Q&A)
- 사용자 인증 (이메일, Google)
- 댓글 기능
- 첨부파일 관리
- Row Level Security (RLS) 보안

---

## 2. 사전 준비사항

### 필수 도구 설치
```bash
# Node.js 18.x 이상 설치 확인
node -v

# npm 또는 yarn 설치 확인
npm -v
```

### 필요한 계정
1. **Supabase 계정**: https://supabase.com
2. **Vercel 계정**: https://vercel.com
3. **Google Cloud Console 계정**: https://console.cloud.google.com (Google OAuth용)

---

## 3. Supabase 프로젝트 생성 및 설정

### 3.1 Supabase 프로젝트 생성

1. Supabase 대시보드 접속: https://app.supabase.com
2. "New Project" 클릭
3. 프로젝트 정보 입력:
   - **Name**: `ai-policy-institute` (또는 원하는 이름)
   - **Database Password**: 강력한 비밀번호 생성 및 저장
   - **Region**: Northeast Asia (Seoul) 선택
   - **Pricing Plan**: Free 선택
4. "Create new project" 클릭
5. 프로젝트 생성 완료 (약 2분 소요)

### 3.2 프로젝트 API 키 확인

프로젝트 생성 후:
1. 좌측 메뉴에서 "Settings" → "API" 클릭
2. 다음 정보 복사 및 저장:
   - **Project URL**: `https://[프로젝트-id].supabase.co`
   - **anon public key**: `eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...`

---

## 4. 데이터베이스 스키마 구축

### 4.1 SQL Editor 접속

1. Supabase 대시보드 좌측 메뉴에서 "SQL Editor" 클릭
2. "New Query" 버튼 클릭

### 4.2 데이터베이스 테이블 생성

아래 SQL 스크립트 전체를 복사하여 SQL Editor에 붙여넣고 "Run" 버튼 클릭:

```sql
-- AI 정책연구소 게시판 테이블 생성 스크립트
-- Supabase SQL Editor에서 실행하세요

-- 1. posts 테이블 생성
CREATE TABLE IF NOT EXISTS posts (
  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
  title TEXT NOT NULL,
  content TEXT NOT NULL,
  category TEXT NOT NULL CHECK (category IN ('notice', 'data', 'qna')),
  author_id UUID REFERENCES auth.users(id) ON DELETE SET NULL,
  author_name TEXT NOT NULL,
  view_count INTEGER DEFAULT 0,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT TIMEZONE('utc'::text, NOW()) NOT NULL,
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT TIMEZONE('utc'::text, NOW()) NOT NULL
);

-- 2. comments 테이블 생성
CREATE TABLE IF NOT EXISTS comments (
  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
  post_id UUID REFERENCES posts(id) ON DELETE CASCADE NOT NULL,
  content TEXT NOT NULL,
  author_id UUID REFERENCES auth.users(id) ON DELETE SET NULL,
  author_name TEXT NOT NULL,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT TIMEZONE('utc'::text, NOW()) NOT NULL,
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT TIMEZONE('utc'::text, NOW()) NOT NULL
);

-- 3. attachments 테이블 생성
CREATE TABLE IF NOT EXISTS attachments (
  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
  post_id UUID REFERENCES posts(id) ON DELETE CASCADE NOT NULL,
  file_name TEXT NOT NULL,
  file_url TEXT NOT NULL,
  file_size INTEGER NOT NULL,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT TIMEZONE('utc'::text, NOW()) NOT NULL
);

-- 4. 인덱스 생성
CREATE INDEX IF NOT EXISTS idx_posts_category ON posts(category);
CREATE INDEX IF NOT EXISTS idx_posts_created_at ON posts(created_at DESC);
CREATE INDEX IF NOT EXISTS idx_comments_post_id ON comments(post_id);
CREATE INDEX IF NOT EXISTS idx_attachments_post_id ON attachments(post_id);

-- 5. RLS (Row Level Security) 활성화
ALTER TABLE posts ENABLE ROW LEVEL SECURITY;
ALTER TABLE comments ENABLE ROW LEVEL SECURITY;
ALTER TABLE attachments ENABLE ROW LEVEL SECURITY;

-- 6. RLS 정책 생성 (모든 사용자가 읽을 수 있음)
CREATE POLICY "Posts are viewable by everyone" ON posts
  FOR SELECT USING (true);

CREATE POLICY "Comments are viewable by everyone" ON comments
  FOR SELECT USING (true);

CREATE POLICY "Attachments are viewable by everyone" ON attachments
  FOR SELECT USING (true);

-- 7. 인증된 사용자만 글 작성 가능
CREATE POLICY "Authenticated users can create posts" ON posts
  FOR INSERT WITH CHECK (auth.role() = 'authenticated');

CREATE POLICY "Authenticated users can create comments" ON comments
  FOR INSERT WITH CHECK (auth.role() = 'authenticated');

-- 8. 자신이 작성한 글만 수정/삭제 가능
CREATE POLICY "Users can update their own posts" ON posts
  FOR UPDATE USING (auth.uid() = author_id);

CREATE POLICY "Users can delete their own posts" ON posts
  FOR DELETE USING (auth.uid() = author_id);

CREATE POLICY "Users can update their own comments" ON comments
  FOR UPDATE USING (auth.uid() = author_id);

CREATE POLICY "Users can delete their own comments" ON comments
  FOR DELETE USING (auth.uid() = author_id);

-- 9. 초기 샘플 데이터 삽입
INSERT INTO posts (id, title, content, category, author_id, author_name, view_count, created_at, updated_at)
VALUES
  (
    '00000000-0000-0000-0000-000000000001',
    '한신대학교 AI 정책연구소 설립 공지',
    E'안녕하세요.\n\n한신대학교 AI 정책연구소가 2025년 12월 29일 한신대학교 학술원 산하 연구소로 공식 설립되었음을 알려드립니다.\n\n■ 연구소 개요\n- 명칭: 한신대학교 AI 정책연구소\n- 설립일: 2025년 12월 29일\n- 소속: 한신대학교 학술원\n- 비전: 국가·지자체의 AI기반 공공혁신을 위한 연구 허브\n\n■ 연구소 구성\n- 연구소장: 노승철 교수\n- AI 행정혁신실 (실장: 윤건 교수)\n- AI 지역학연구실 (실장: 주장환 교수)\n- AI 개발창업실 (실장: 이석민 교수)\n\n■ 미션\nAI와 데이터 과학을 통해 행정의 과학화·투명화·효율화를 촉진하고,\n공공가치 창출과 지역사회 문제 해결에 기여합니다.\n\n■ 핵심가치\n- 공공성 (Responsibility)\n- 신뢰성 (Reliability)\n- 투명성 (Transparency)\n- 포용성 (Inclusion)\n- 개방성 (Open Collaboration)\n\n앞으로 AI 기술을 통한 공공혁신 연구에 최선을 다하겠습니다.\n많은 관심과 협력 부탁드립니다.\n\n감사합니다.\n\n한신대학교 AI 정책연구소',
    'notice',
    NULL,
    '관리자',
    1,
    '2025-12-29 10:00:00+00',
    '2025-12-29 10:00:00+00'
  ),
  (
    '00000000-0000-0000-0000-000000000002',
    '2025년 상반기 AI 정책 세미나 개최 안내 (테스트)',
    E'안녕하세요, AI 정책연구소입니다.\n\n2025년 상반기 AI 정책 세미나를 아래와 같이 개최합니다.\n\n■ 일시: 2025년 4월 15일(월) 14:00-17:00\n■ 장소: 한신대학교 소통관\n■ 주제: \"생성형 AI 시대의 정책 방향\"\n\n■ 프로그램\n- 14:00-14:30 개회 및 기조연설\n- 14:30-15:30 발표 1: 생성형 AI의 현황과 전망\n- 15:30-15:50 휴식\n- 15:50-16:50 발표 2: AI 규제 정책의 국제 동향\n- 16:50-17:00 폐회\n\n많은 관심과 참여 부탁드립니다.\n\n감사합니다.',
    'notice',
    NULL,
    '관리자',
    156,
    '2025-01-15 09:00:00+00',
    '2025-01-15 09:00:00+00'
  ),
  (
    '00000000-0000-0000-0000-000000000003',
    'AI 윤리 가이드라인 연구보고서 (테스트)',
    E'AI 윤리 가이드라인 연구보고서를 공유합니다.\n\n본 보고서는 국내 AI 개발 및 활용을 위한 윤리적 가이드라인을 제안합니다.\n\n자세한 내용은 첨부파일을 참고해주세요.',
    'data',
    NULL,
    '김연구',
    89,
    '2025-01-10 09:00:00+00',
    '2025-01-10 09:00:00+00'
  ),
  (
    '00000000-0000-0000-0000-000000000004',
    '연구소 방문 문의드립니다 (테스트)',
    E'안녕하세요.\n\n연구소 방문 일정을 잡고 싶어 문의드립니다.\n\n가능한 날짜와 시간을 알려주시면 감사하겠습니다.',
    'qna',
    NULL,
    '홍길동',
    23,
    '2025-01-08 09:00:00+00',
    '2025-01-08 09:00:00+00'
  )
ON CONFLICT (id) DO NOTHING;

-- 10. updated_at 자동 업데이트 함수 생성
CREATE OR REPLACE FUNCTION update_updated_at_column()
RETURNS TRIGGER AS $$
BEGIN
  NEW.updated_at = TIMEZONE('utc'::text, NOW());
  RETURN NEW;
END;
$$ language 'plpgsql';

-- 11. updated_at 트리거 생성
CREATE TRIGGER update_posts_updated_at BEFORE UPDATE ON posts
  FOR EACH ROW EXECUTE FUNCTION update_updated_at_column();

CREATE TRIGGER update_comments_updated_at BEFORE UPDATE ON comments
  FOR EACH ROW EXECUTE FUNCTION update_updated_at_column();
```

### 4.3 테이블 생성 확인

1. 좌측 메뉴에서 "Table Editor" 클릭
2. `posts`, `comments`, `attachments` 테이블이 생성되었는지 확인
3. 각 테이블을 클릭하여 샘플 데이터가 삽입되었는지 확인

---

## 5. 인증(Authentication) 설정

### 5.1 이메일 인증 설정 (이메일 확인 없이 가입)

**이메일 인증을 생략하고 즉시 가입하는 방법:**

1. Supabase 대시보드 좌측 메뉴에서 "Authentication" 클릭
2. "Providers" 탭 클릭
3. "Email" 프로바이더 클릭하여 설정 열기
4. **"Confirm email" 토글을 OFF로 설정**
5. 또는 "Settings" → "Auth" → "Email Auth" 섹션에서:
   - **"Enable email confirmations" 체크박스 해제**
6. "Save" 버튼 클릭

**설정 코드 (Supabase CLI를 사용하는 경우):**
```toml
# config.toml
[auth.email]
enable_signup = true
double_confirm_changes = true
enable_confirmations = false  # 이메일 인증 비활성화
```

이 설정을 적용하면:
- 사용자가 회원가입 시 즉시 계정이 활성화됨
- 이메일 인증 링크를 클릭할 필요 없음
- 바로 로그인하여 서비스 이용 가능

**주의사항:**
- 프로덕션 환경에서는 보안을 위해 이메일 인증을 활성화하는 것을 권장
- 테스트/개발 환경에서만 이메일 인증을 비활성화할 것

### 5.2 Google OAuth 설정

#### 5.2.1 Google Cloud Console에서 OAuth 클라이언트 생성

1. **Google Cloud Console 접속**: https://console.cloud.google.com
2. **프로젝트 생성** (없는 경우):
   - 상단 프로젝트 드롭다운 클릭
   - "새 프로젝트" 클릭
   - 프로젝트 이름 입력: `ai-policy-institute`
   - "만들기" 클릭

3. **OAuth 동의 화면 구성**:
   - 좌측 메뉴에서 "API 및 서비스" → "OAuth 동의 화면" 클릭
   - User Type: "외부" 선택 → "만들기"
   - 앱 정보 입력:
     - 앱 이름: `한신대학교 AI 정책연구소`
     - 사용자 지원 이메일: 본인 이메일
     - 개발자 연락처 정보: 본인 이메일
   - "저장 후 계속" 클릭
   - 범위: 기본값 유지 → "저장 후 계속"
   - 테스트 사용자: 필요시 추가 → "저장 후 계속"

4. **OAuth 클라이언트 ID 생성**:
   - 좌측 메뉴에서 "API 및 서비스" → "사용자 인증 정보" 클릭
   - 상단 "+ 사용자 인증 정보 만들기" → "OAuth 클라이언트 ID" 선택
   - 애플리케이션 유형: "웹 애플리케이션"
   - 이름: `AI Policy Institute Web`
   - 승인된 리디렉션 URI:
     ```
     https://[프로젝트-id].supabase.co/auth/v1/callback
     ```
     (예: `https://nnahzwqjmounacacbihr.supabase.co/auth/v1/callback`)
   - "만들기" 클릭
   - **클라이언트 ID**와 **클라이언트 보안 비밀** 복사 및 저장

#### 5.2.2 Supabase에 Google OAuth 연동

1. Supabase 대시보드 "Authentication" → "Providers" 이동
2. "Google" 프로바이더 찾아서 클릭
3. 설정 입력:
   - **Enabled**: ON으로 토글
   - **Client ID**: Google에서 복사한 클라이언트 ID 붙여넣기
   - **Client Secret**: Google에서 복사한 클라이언트 보안 비밀 붙여넣기
4. "Save" 버튼 클릭

### 5.3 네이버 OAuth 설정 (선택사항)

#### 5.3.1 네이버 개발자 센터에서 애플리케이션 등록

1. **네이버 개발자 센터 접속**: https://developers.naver.com
2. **네이버 아이디로 로그인** 클릭하여 로그인
3. **애플리케이션 등록**:
   - 상단 "Application" → "애플리케이션 등록" 클릭
   - 애플리케이션 이름: `한신대학교 AI 정책연구소`
   - 사용 API: "네이버 로그인" 체크
   - 제공 정보 선택: "이메일", "이름" 필수 체크
   - 로그인 오픈 API 서비스 환경:
     - PC 웹: `http://localhost:3000` (개발용)
     - PC 웹: `https://your-domain.vercel.app` (프로덕션용)
   - 네이버아이디로로그인 Callback URL:
     ```
     https://[프로젝트-id].supabase.co/auth/v1/callback
     ```
   - "등록하기" 클릭
4. **Client ID**와 **Client Secret** 복사 및 저장

#### 5.3.2 Supabase 커스텀 OAuth 설정

**주의**: Supabase는 기본적으로 네이버 OAuth를 지원하지 않습니다. 커스텀 구현이 필요합니다.

네이버 OAuth 연동을 위한 커스텀 구현 방법:

1. **환경 변수 추가** (`.env.local`):
```env
NEXT_PUBLIC_NAVER_CLIENT_ID=your_naver_client_id
NAVER_CLIENT_SECRET=your_naver_client_secret
```

2. **API Route 생성** (`app/api/auth/naver/route.ts`):
```typescript
import { NextResponse } from 'next/server'

export async function GET(request: Request) {
  const clientId = process.env.NEXT_PUBLIC_NAVER_CLIENT_ID
  const redirectUri = encodeURIComponent(`${process.env.NEXT_PUBLIC_SITE_URL}/api/auth/naver/callback`)
  const state = Math.random().toString(36).substring(7)

  const naverAuthUrl = `https://nid.naver.com/oauth2.0/authorize?response_type=code&client_id=${clientId}&redirect_uri=${redirectUri}&state=${state}`

  return NextResponse.redirect(naverAuthUrl)
}
```

3. **Callback Route 생성** (`app/api/auth/naver/callback/route.ts`):
```typescript
import { NextResponse } from 'next/server'
import { createClient } from '@/lib/supabase/server'

export async function GET(request: Request) {
  const { searchParams } = new URL(request.url)
  const code = searchParams.get('code')
  const state = searchParams.get('state')

  if (!code) {
    return NextResponse.redirect(new URL('/login?error=naver_auth_failed', request.url))
  }

  // 네이버 액세스 토큰 요청
  const tokenResponse = await fetch('https://nid.naver.com/oauth2.0/token', {
    method: 'POST',
    headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
    body: new URLSearchParams({
      grant_type: 'authorization_code',
      client_id: process.env.NEXT_PUBLIC_NAVER_CLIENT_ID!,
      client_secret: process.env.NAVER_CLIENT_SECRET!,
      code,
      state: state || '',
    }),
  })

  const tokenData = await tokenResponse.json()

  if (!tokenData.access_token) {
    return NextResponse.redirect(new URL('/login?error=naver_token_failed', request.url))
  }

  // 네이버 사용자 정보 요청
  const userResponse = await fetch('https://openapi.naver.com/v1/nid/me', {
    headers: { Authorization: `Bearer ${tokenData.access_token}` },
  })

  const userData = await userResponse.json()

  if (userData.resultcode !== '00') {
    return NextResponse.redirect(new URL('/login?error=naver_user_failed', request.url))
  }

  const { email, name } = userData.response

  // Supabase에 사용자 생성 또는 로그인
  const supabase = await createClient()
  const { error } = await supabase.auth.signInWithPassword({
    email,
    password: `naver_${userData.response.id}`, // 임시 비밀번호
  })

  if (error) {
    // 사용자가 없으면 회원가입
    await supabase.auth.signUp({
      email,
      password: `naver_${userData.response.id}`,
      options: {
        data: { name, provider: 'naver' },
      },
    })
  }

  return NextResponse.redirect(new URL('/', request.url))
}
```

**참고**: 네이버 OAuth는 복잡한 커스텀 구현이 필요하므로, 프로젝트 요구사항에 따라 선택적으로 구현하세요.

### 5.4 자동 사용자 확인 설정 (선택사항)

테스트 환경에서 모든 사용자를 자동으로 확인하려면:

1. Supabase 대시보드 "Authentication" → "Users" 이동
2. 특정 사용자 클릭
3. "Auto Confirm User" 토글을 ON으로 설정

또는 설정에서 전체 자동 확인:
1. "Settings" → "Auth" 이동
2. "Enable email confirmations" 체크박스 해제

---

## 6. Next.js 프로젝트 설정

### 6.1 프로젝트 초기화

```bash
# 프로젝트 디렉토리 생성
mkdir ai_center
cd ai_center

# Next.js 프로젝트 초기화
npx create-next-app@14.2.35 . --typescript --tailwind --app --no-src-dir

# 또는 수동으로 package.json 생성 후:
npm init -y
```

### 6.2 필수 패키지 설치

```bash
# Supabase 클라이언트 라이브러리
npm install @supabase/supabase-js@2.89.0 @supabase/ssr@0.8.0

# Next.js 및 React
npm install next@14.2.35 react@18.3.1 react-dom@18.3.1

# TypeScript
npm install -D typescript@5.9.3 @types/react@19.2.7 @types/react-dom@19.2.3 @types/node@25.0.3

# Tailwind CSS 및 UI 라이브러리
npm install tailwindcss@3.4.19 postcss@8.5.6 autoprefixer@10.4.23
npm install tailwindcss-animate@1.0.7 class-variance-authority@0.7.1 clsx@2.1.1 tailwind-merge@3.4.0

# Radix UI 컴포넌트
npm install @radix-ui/react-navigation-menu@1.2.14 @radix-ui/react-separator@1.1.8 @radix-ui/react-slot@1.2.4

# 아이콘 라이브러리
npm install lucide-react@0.562.0
```

### 6.3 package.json 스크립트 설정

`package.json`에 다음 스크립트 추가:

```json
{
  "scripts": {
    "dev": "next dev",
    "build": "next build",
    "start": "next start",
    "lint": "next lint"
  }
}
```

### 6.4 프로젝트 구조 생성

```bash
# 디렉토리 구조 생성
mkdir -p app/{auth/callback,board/{[id],write},login,register,api/auth}
mkdir -p components/{layout,ui}
mkdir -p lib/supabase
mkdir -p public
```

---

## 7. 환경 변수 설정

### 7.1 .env.local 파일 생성

프로젝트 루트에 `.env.local` 파일을 생성하고 다음 내용 추가:

```env
# Supabase 설정
NEXT_PUBLIC_SUPABASE_URL=https://[프로젝트-id].supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

# 사이트 URL (선택사항)
NEXT_PUBLIC_SITE_URL=http://localhost:3000
```

**값 입력 방법**:
1. `[프로젝트-id]`를 Supabase 프로젝트 ID로 교체
2. `NEXT_PUBLIC_SUPABASE_ANON_KEY`에 Supabase 대시보드의 anon key 붙여넣기

### 7.2 .gitignore 설정

`.gitignore` 파일에 환경 변수 파일 제외:

```gitignore
# 환경 변수
.env*.local

# Next.js
.next/
out/
build/
dist/

# 의존성
node_modules/

# 디버그 로그
npm-debug.log*
yarn-debug.log*
```

---

## 8. Supabase 클라이언트 구성

### 8.1 클라이언트 사이드 Supabase 클라이언트

`lib/supabase/client.ts` 파일 생성:

```typescript
import { createBrowserClient } from '@supabase/ssr'

const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL || 'https://placeholder.supabase.co'
const supabaseKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY || 'placeholder-key'

export function createClient() {
  return createBrowserClient(supabaseUrl, supabaseKey)
}
```

### 8.2 서버 사이드 Supabase 클라이언트

`lib/supabase/server.ts` 파일 생성:

```typescript
import { createServerClient, type CookieOptions } from '@supabase/ssr'
import { cookies } from 'next/headers'

const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL || 'https://placeholder.supabase.co'
const supabaseKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY || 'placeholder-key'

export async function createClient() {
  const cookieStore = await cookies()

  return createServerClient(
    supabaseUrl,
    supabaseKey,
    {
      cookies: {
        getAll() {
          return cookieStore.getAll()
        },
        setAll(cookiesToSet) {
          try {
            cookiesToSet.forEach(({ name, value, options }) =>
              cookieStore.set(name, value, options)
            )
          } catch {
            // Server Component에서 호출 시 무시
          }
        },
      },
    }
  )
}
```

### 8.3 유틸리티 함수 (선택사항)

`lib/utils.ts` 파일 생성:

```typescript
import { type ClassValue, clsx } from "clsx"
import { twMerge } from "tailwind-merge"

export function cn(...inputs: ClassValue[]) {
  return twMerge(clsx(inputs))
}
```

---

## 9. 게시판 기능 구현

### 9.1 인증 페이지 구현

#### 9.1.1 로그인 페이지 (`app/login/page.tsx`)

```typescript
'use client'

import { useState } from 'react'
import { createClient } from '@/lib/supabase/client'
import { useRouter } from 'next/navigation'
import Link from 'next/link'

export default function LoginPage() {
  const [email, setEmail] = useState('')
  const [password, setPassword] = useState('')
  const [error, setError] = useState<string | null>(null)
  const [loading, setLoading] = useState(false)
  const router = useRouter()
  const supabase = createClient()

  const handleLogin = async (e: React.FormEvent) => {
    e.preventDefault()
    setLoading(true)
    setError(null)

    const { error } = await supabase.auth.signInWithPassword({
      email,
      password,
    })

    if (error) {
      setError('이메일 또는 비밀번호가 올바르지 않습니다.')
      setLoading(false)
      return
    }

    router.push('/')
    router.refresh()
  }

  const handleGoogleLogin = async () => {
    const { error } = await supabase.auth.signInWithOAuth({
      provider: 'google',
      options: {
        redirectTo: `${window.location.origin}/auth/callback`,
      },
    })

    if (error) {
      setError('Google 로그인에 실패했습니다.')
    }
  }

  return (
    <div className="min-h-[calc(100vh-200px)] flex items-center justify-center py-12 px-4">
      <div className="max-w-md w-full">
        <div className="text-center mb-8">
          <h1 className="text-3xl font-bold">로그인</h1>
          <p className="text-gray-600 mt-2">AI 정책연구소에 오신 것을 환영합니다</p>
        </div>

        <form onSubmit={handleLogin} className="space-y-6">
          {error && (
            <div className="bg-red-50 text-red-600 p-4 rounded-lg text-sm">
              {error}
            </div>
          )}

          <div>
            <label htmlFor="email" className="block text-sm font-medium text-gray-700 mb-1">
              이메일
            </label>
            <input
              type="email"
              id="email"
              value={email}
              onChange={(e) => setEmail(e.target.value)}
              className="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"
              placeholder="이메일을 입력하세요"
              required
            />
          </div>

          <div>
            <label htmlFor="password" className="block text-sm font-medium text-gray-700 mb-1">
              비밀번호
            </label>
            <input
              type="password"
              id="password"
              value={password}
              onChange={(e) => setPassword(e.target.value)}
              className="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"
              placeholder="비밀번호를 입력하세요"
              required
            />
          </div>

          <button
            type="submit"
            disabled={loading}
            className="w-full bg-primary-600 text-white py-3 rounded-lg font-semibold hover:bg-primary-700 transition-colors disabled:opacity-50"
          >
            {loading ? '로그인 중...' : '로그인'}
          </button>
        </form>

        <div className="my-6">
          <div className="relative">
            <div className="absolute inset-0 flex items-center">
              <div className="w-full border-t border-gray-300"></div>
            </div>
            <div className="relative flex justify-center text-sm">
              <span className="px-2 bg-white text-gray-500">또는</span>
            </div>
          </div>
        </div>

        <button
          onClick={handleGoogleLogin}
          className="w-full flex items-center justify-center gap-3 px-4 py-3 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors"
        >
          <span className="font-medium text-gray-700">Google로 로그인</span>
        </button>

        <div className="mt-6 text-center">
          <p className="text-gray-600">
            계정이 없으신가요?{' '}
            <Link href="/register" className="text-primary-600 hover:text-primary-700 font-medium">
              회원가입
            </Link>
          </p>
        </div>
      </div>
    </div>
  )
}
```

#### 9.1.2 회원가입 페이지 (`app/register/page.tsx`)

```typescript
'use client'

import { useState } from 'react'
import { createClient } from '@/lib/supabase/client'
import { useRouter } from 'next/navigation'
import Link from 'next/link'

export default function RegisterPage() {
  const [email, setEmail] = useState('')
  const [password, setPassword] = useState('')
  const [confirmPassword, setConfirmPassword] = useState('')
  const [name, setName] = useState('')
  const [error, setError] = useState<string | null>(null)
  const [loading, setLoading] = useState(false)
  const [success, setSuccess] = useState(false)
  const router = useRouter()
  const supabase = createClient()

  const handleRegister = async (e: React.FormEvent) => {
    e.preventDefault()
    setLoading(true)
    setError(null)

    if (password !== confirmPassword) {
      setError('비밀번호가 일치하지 않습니다.')
      setLoading(false)
      return
    }

    if (password.length < 6) {
      setError('비밀번호는 최소 6자 이상이어야 합니다.')
      setLoading(false)
      return
    }

    const { error } = await supabase.auth.signUp({
      email,
      password,
      options: {
        data: {
          name,
        },
      },
    })

    if (error) {
      setError('회원가입에 실패했습니다. 다시 시도해 주세요.')
      setLoading(false)
      return
    }

    setSuccess(true)
  }

  const handleGoogleSignUp = async () => {
    const { error } = await supabase.auth.signInWithOAuth({
      provider: 'google',
      options: {
        redirectTo: `${window.location.origin}/auth/callback`,
      },
    })

    if (error) {
      setError('Google 회원가입에 실패했습니다.')
    }
  }

  if (success) {
    return (
      <div className="min-h-[calc(100vh-200px)] flex items-center justify-center py-12 px-4">
        <div className="max-w-md w-full text-center">
          <div className="bg-green-50 text-green-700 p-8 rounded-xl">
            <h2 className="text-2xl font-bold mb-4">회원가입 완료</h2>
            <p className="mb-6">
              회원가입이 완료되었습니다.<br />
              로그인하여 서비스를 이용해 주세요.
            </p>
            <Link
              href="/login"
              className="inline-block bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 transition-colors"
            >
              로그인 페이지로 이동
            </Link>
          </div>
        </div>
      </div>
    )
  }

  return (
    <div className="min-h-[calc(100vh-200px)] flex items-center justify-center py-12 px-4">
      <div className="max-w-md w-full">
        <div className="text-center mb-8">
          <h1 className="text-3xl font-bold">회원가입</h1>
          <p className="text-gray-600 mt-2">AI 정책연구소 회원이 되어주세요</p>
        </div>

        <form onSubmit={handleRegister} className="space-y-6">
          {error && (
            <div className="bg-red-50 text-red-600 p-4 rounded-lg text-sm">
              {error}
            </div>
          )}

          <div>
            <label htmlFor="name" className="block text-sm font-medium text-gray-700 mb-1">
              이름
            </label>
            <input
              type="text"
              id="name"
              value={name}
              onChange={(e) => setName(e.target.value)}
              className="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"
              placeholder="이름을 입력하세요"
              required
            />
          </div>

          <div>
            <label htmlFor="email" className="block text-sm font-medium text-gray-700 mb-1">
              이메일
            </label>
            <input
              type="email"
              id="email"
              value={email}
              onChange={(e) => setEmail(e.target.value)}
              className="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"
              placeholder="이메일을 입력하세요"
              required
            />
          </div>

          <div>
            <label htmlFor="password" className="block text-sm font-medium text-gray-700 mb-1">
              비밀번호
            </label>
            <input
              type="password"
              id="password"
              value={password}
              onChange={(e) => setPassword(e.target.value)}
              className="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"
              placeholder="비밀번호를 입력하세요 (최소 6자)"
              required
            />
          </div>

          <div>
            <label htmlFor="confirmPassword" className="block text-sm font-medium text-gray-700 mb-1">
              비밀번호 확인
            </label>
            <input
              type="password"
              id="confirmPassword"
              value={confirmPassword}
              onChange={(e) => setConfirmPassword(e.target.value)}
              className="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"
              placeholder="비밀번호를 다시 입력하세요"
              required
            />
          </div>

          <button
            type="submit"
            disabled={loading}
            className="w-full bg-primary-600 text-white py-3 rounded-lg font-semibold hover:bg-primary-700 transition-colors disabled:opacity-50"
          >
            {loading ? '가입 처리 중...' : '회원가입'}
          </button>
        </form>

        <div className="my-6">
          <div className="relative">
            <div className="absolute inset-0 flex items-center">
              <div className="w-full border-t border-gray-300"></div>
            </div>
            <div className="relative flex justify-center text-sm">
              <span className="px-2 bg-white text-gray-500">또는</span>
            </div>
          </div>
        </div>

        <button
          onClick={handleGoogleSignUp}
          className="w-full flex items-center justify-center gap-3 px-4 py-3 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors"
        >
          <span className="font-medium text-gray-700">Google로 회원가입</span>
        </button>

        <div className="mt-6 text-center">
          <p className="text-gray-600">
            이미 계정이 있으신가요?{' '}
            <Link href="/login" className="text-primary-600 hover:text-primary-700 font-medium">
              로그인
            </Link>
          </p>
        </div>
      </div>
    </div>
  )
}
```

#### 9.1.3 OAuth 콜백 처리 (`app/auth/callback/route.ts`)

```typescript
import { createClient } from '@/lib/supabase/server'
import { NextResponse } from 'next/server'

export async function GET(request: Request) {
  const requestUrl = new URL(request.url)
  const code = requestUrl.searchParams.get('code')

  if (code) {
    const supabase = await createClient()
    await supabase.auth.exchangeCodeForSession(code)
  }

  // URL to redirect to after sign in process completes
  return NextResponse.redirect(new URL('/', requestUrl.origin))
}
```

### 9.2 게시판 목록 페이지

게시판 목록 페이지를 구현하려면 `app/board/page.tsx` 파일을 생성하고, Supabase에서 게시글을 조회하는 로직을 추가합니다.

**참고**: 현재 프로젝트의 `app/board/page.tsx` 파일을 참조하세요.

### 9.3 게시글 상세 페이지

게시글 상세 페이지 구현 예시는 `app/board/[id]/page.tsx`를 참고하세요.

---

## 10. Vercel 배포

### 10.1 Vercel 프로젝트 생성

1. **Vercel 계정 로그인**: https://vercel.com
2. **New Project** 클릭
3. **Git Repository 연결**:
   - GitHub/GitLab/Bitbucket 중 선택
   - 저장소 권한 부여
   - `ai_center` 저장소 선택
4. **프로젝트 설정**:
   - Framework Preset: `Next.js` (자동 감지)
   - Root Directory: `./` (기본값)
   - Build Command: `npm run build` (기본값)
   - Output Directory: `.next` (기본값)

### 10.2 환경 변수 설정

Vercel 프로젝트 설정에서:
1. "Settings" → "Environment Variables" 이동
2. 다음 환경 변수 추가:
   - **NEXT_PUBLIC_SUPABASE_URL**: Supabase 프로젝트 URL
   - **NEXT_PUBLIC_SUPABASE_ANON_KEY**: Supabase anon key
   - **NEXT_PUBLIC_SITE_URL**: Vercel 배포 URL (예: `https://ai-center.vercel.app`)
3. Environment: `Production`, `Preview`, `Development` 모두 선택
4. "Save" 클릭

### 10.3 배포 실행

1. "Deploy" 버튼 클릭
2. 배포 진행 상황 확인 (약 2-3분 소요)
3. 배포 완료 후 생성된 URL 확인

### 10.4 커스텀 도메인 설정 (선택사항)

1. Vercel 프로젝트 "Settings" → "Domains" 이동
2. 도메인 추가 및 DNS 설정
3. SSL 인증서 자동 발급

---

## 11. 테스트 및 확인

### 11.1 로컬 개발 서버 실행

```bash
npm run dev
```

브라우저에서 `http://localhost:3000` 접속

### 11.2 기능 테스트 체크리스트

#### 인증 테스트
- [ ] 이메일 회원가입 (이메일 인증 없이 즉시 가입되는지 확인)
- [ ] 이메일 로그인
- [ ] Google 로그인
- [ ] 로그아웃

#### 게시판 테스트
- [ ] 게시글 목록 조회
- [ ] 게시글 상세 보기
- [ ] 게시글 작성 (로그인 후)
- [ ] 게시글 수정 (본인 글만)
- [ ] 게시글 삭제 (본인 글만)
- [ ] 댓글 작성
- [ ] 댓글 삭제
- [ ] 카테고리별 필터링 (공지사항, 자료실, Q&A)
- [ ] 조회수 증가

#### 보안 테스트
- [ ] 비로그인 상태에서 글 작성 차단
- [ ] 다른 사용자 글 수정/삭제 차단
- [ ] RLS 정책 작동 확인

### 11.3 Supabase 데이터 확인

1. Supabase 대시보드 "Table Editor" 이동
2. `posts` 테이블에서 게시글 데이터 확인
3. `auth.users` 테이블에서 사용자 데이터 확인

### 11.4 프로덕션 배포 확인

1. Vercel 배포 URL 접속
2. 모든 기능이 정상 작동하는지 확인
3. HTTPS 인증서 정상 적용 확인

---

## 12. 문제 해결 (Troubleshooting)

### 12.1 이메일 인증 관련 문제

**문제**: 회원가입 후 "이메일 인증을 확인하세요" 메시지가 표시됨

**해결**:
1. Supabase "Authentication" → "Providers" → "Email" 이동
2. "Confirm email" 토글을 OFF로 설정
3. 또는 "Settings" → "Auth"에서 "Enable email confirmations" 체크 해제

### 12.2 환경 변수 오류

**문제**: `NEXT_PUBLIC_SUPABASE_URL is not defined`

**해결**:
1. `.env.local` 파일이 프로젝트 루트에 있는지 확인
2. 환경 변수 이름 철자 확인
3. 개발 서버 재시작: `npm run dev`

### 12.3 Supabase 연결 오류

**문제**: `Failed to fetch` 또는 `Invalid API key`

**해결**:
1. Supabase 프로젝트 URL이 올바른지 확인
2. Anon key가 올바르게 복사되었는지 확인
3. Supabase 프로젝트가 활성화되어 있는지 확인

### 12.4 RLS 정책 오류

**문제**: `new row violates row-level security policy`

**해결**:
1. Supabase SQL Editor에서 RLS 정책 확인
2. 필요시 정책 재생성
3. `auth.role()` 함수가 올바르게 작동하는지 확인

### 12.5 Google OAuth 오류

**문제**: `Error 400: redirect_uri_mismatch`

**해결**:
1. Google Cloud Console에서 리디렉션 URI 확인
2. Supabase 콜백 URL 형식: `https://[프로젝트-id].supabase.co/auth/v1/callback`
3. 정확히 일치하는지 확인 (trailing slash 주의)

---

## 13. 추가 자료

### 13.1 공식 문서
- Next.js: https://nextjs.org/docs
- Supabase: https://supabase.com/docs
- Vercel: https://vercel.com/docs
- Tailwind CSS: https://tailwindcss.com/docs

### 13.2 유용한 명령어

```bash
# 개발 서버 실행
npm run dev

# 프로덕션 빌드
npm run build

# 프로덕션 서버 실행
npm run start

# 린트 검사
npm run lint

# 패키지 업데이트
npm update

# 캐시 클리어
rm -rf .next
npm run dev
```

### 13.3 디버깅 팁

1. **브라우저 콘솔 확인**: Chrome DevTools (F12)
2. **네트워크 탭 확인**: API 요청/응답 확인
3. **Supabase Logs 확인**: Supabase 대시보드 "Logs" 탭
4. **Vercel Logs 확인**: Vercel 프로젝트 "Deployments" → "Functions" 로그

---

## 14. 프로젝트 파일 구조

```
ai_center/
├── app/
│   ├── auth/
│   │   └── callback/
│   │       └── route.ts          # OAuth 콜백 처리
│   ├── board/
│   │   ├── [id]/
│   │   │   ├── page.tsx          # 게시글 상세
│   │   │   ├── CommentSection.tsx # 댓글 컴포넌트
│   │   │   └── DeleteButton.tsx  # 삭제 버튼
│   │   ├── write/
│   │   │   └── page.tsx          # 게시글 작성/수정
│   │   └── page.tsx              # 게시판 목록
│   ├── login/
│   │   └── page.tsx              # 로그인 페이지
│   ├── register/
│   │   └── page.tsx              # 회원가입 페이지
│   ├── globals.css               # 전역 스타일
│   ├── layout.tsx                # 루트 레이아웃
│   └── page.tsx                  # 홈페이지
├── components/
│   ├── layout/
│   │   ├── Header.tsx            # 헤더
│   │   └── Footer.tsx            # 푸터
│   └── ui/                       # UI 컴포넌트
├── lib/
│   ├── supabase/
│   │   ├── client.ts             # 클라이언트 사이드 Supabase
│   │   └── server.ts             # 서버 사이드 Supabase
│   └── utils.ts                  # 유틸리티 함수
├── public/                       # 정적 파일
├── .env.local                    # 환경 변수 (git 제외)
├── .gitignore
├── next.config.js                # Next.js 설정
├── package.json                  # 패키지 정보
├── tailwind.config.js            # Tailwind 설정
├── tsconfig.json                 # TypeScript 설정
└── supabase_setup.sql           # 데이터베이스 스키마
```

---

## 15. 관리자 기능 구현 (선택사항)

관리자가 모든 게시글을 관리할 수 있는 기능을 추가합니다.

### 15.1 관리자 기능 개요

- 관리자는 모든 사용자의 게시글과 댓글을 수정/삭제할 수 있습니다
- 관리자 전용 대시보드에서 게시글 및 사용자 목록을 확인할 수 있습니다
- 사용자 역할(admin/user) 기반 권한 관리

### 15.2 관리자 기능이 포함된 데이터베이스 스키마

기존 `supabase_setup.sql` 대신 `supabase_setup_with_admin.sql` 파일을 사용합니다.

**새로운 스키마의 주요 변경사항:**

1. **user_roles 테이블 추가**:
   - 사용자별 역할(admin/user) 관리
   - 신규 사용자는 자동으로 'user' 역할 부여

2. **RLS 정책 업데이트**:
   - 관리자는 모든 게시글 수정/삭제 가능
   - 일반 사용자는 자신의 글만 수정/삭제 가능

3. **관리자 확인 헬퍼 함수**:
   ```sql
   CREATE OR REPLACE FUNCTION is_admin(user_uuid UUID)
   RETURNS BOOLEAN
   ```

### 15.3 데이터베이스 재생성

**주의**: 기존 데이터가 삭제됩니다. 프로젝트 초기 단계에서만 수행하세요.

1. Supabase 대시보드 → SQL Editor 이동
2. 기존 테이블 삭제:
```sql
DROP TABLE IF EXISTS attachments CASCADE;
DROP TABLE IF EXISTS comments CASCADE;
DROP TABLE IF EXISTS posts CASCADE;
DROP TABLE IF EXISTS user_roles CASCADE;
DROP FUNCTION IF EXISTS is_admin CASCADE;
DROP FUNCTION IF EXISTS handle_new_user CASCADE;
DROP FUNCTION IF EXISTS update_updated_at_column CASCADE;
```

3. `supabase_setup_with_admin.sql` 파일의 전체 내용 복사
4. SQL Editor에 붙여넣기 후 "Run" 실행

### 15.4 관리자 계정 설정

#### 방법 1: 이메일로 관리자 지정 (권장)

회원가입 후 Supabase SQL Editor에서 실행:

```sql
-- 이메일로 관리자 지정
UPDATE user_roles
SET role = 'admin'
WHERE user_id = (
  SELECT id FROM auth.users WHERE email = 'admin@hs.ac.kr'
);
```

#### 방법 2: UUID로 관리자 지정

1. Supabase 대시보드 → Authentication → Users 이동
2. 관리자로 지정할 사용자의 UUID 복사
3. SQL Editor에서 실행:
```sql
UPDATE user_roles
SET role = 'admin'
WHERE user_id = '사용자-UUID';
```

### 15.5 관리자 권한 확인 유틸리티

`lib/auth.ts` 파일이 자동 생성되어 있어야 합니다:

```typescript
import { isAdminServer, isAdminClient } from '@/lib/auth'

// 서버 컴포넌트에서
const isAdmin = await isAdminServer()

// 클라이언트 컴포넌트에서
const isAdmin = await isAdminClient()
```

### 15.6 관리자 대시보드

`/admin` 경로로 접속하면 관리자 전용 대시보드를 확인할 수 있습니다.

**주요 기능:**
- 전체 게시글 목록 및 통계
- 전체 사용자 목록 및 역할 확인
- 게시글 바로가기 링크

**접근 제한:**
- 관리자가 아닌 사용자는 자동으로 홈페이지로 리다이렉트됩니다

### 15.7 게시글 상세 페이지 관리자 권한

관리자로 로그인하면:
- 모든 게시글에 "관리자 권한" 배지가 표시됩니다
- 수정/삭제 버튼이 활성화됩니다
- 다른 사용자의 게시글도 관리할 수 있습니다

### 15.8 헤더 메뉴 관리자 링크

관리자로 로그인하면 헤더에 "관리자" 버튼이 표시되어 대시보드로 바로 이동할 수 있습니다.

### 15.9 테스트

1. **일반 사용자로 회원가입**:
   - 이메일: `user@test.com`
   - 게시글 작성 가능
   - 자신의 글만 수정/삭제 가능

2. **관리자 계정 생성**:
   ```sql
   UPDATE user_roles
   SET role = 'admin'
   WHERE user_id = (SELECT id FROM auth.users WHERE email = 'admin@hs.ac.kr');
   ```

3. **관리자로 로그인**:
   - 헤더에 "관리자" 버튼 표시 확인
   - `/admin` 접속하여 대시보드 확인
   - 다른 사용자의 게시글 수정/삭제 가능 확인

### 15.10 프로젝트 파일 구조 (관리자 기능 포함)

```
ai_center/
├── app/
│   ├── admin/
│   │   └── page.tsx              # 관리자 대시보드 ★ NEW
│   ├── auth/
│   │   └── callback/
│   │       └── route.ts          # OAuth 콜백 처리
│   ├── board/
│   │   ├── [id]/
│   │   │   ├── page.tsx          # 게시글 상세 (관리자 권한 포함) ★ UPDATED
│   │   │   ├── CommentSection.tsx
│   │   │   └── DeleteButton.tsx
│   │   ├── write/
│   │   │   └── page.tsx
│   │   └── page.tsx
│   ├── login/
│   │   └── page.tsx
│   ├── register/
│   │   └── page.tsx
│   ├── globals.css
│   ├── layout.tsx
│   └── page.tsx
├── components/
│   ├── layout/
│   │   ├── Header.tsx            # 관리자 링크 포함 ★ UPDATED
│   │   └── Footer.tsx
│   └── ui/
├── lib/
│   ├── supabase/
│   │   ├── client.ts
│   │   └── server.ts
│   ├── auth.ts                   # 관리자 권한 유틸리티 ★ NEW
│   └── utils.ts
├── public/
├── .env.local
├── .gitignore
├── next.config.js
├── package.json
├── tailwind.config.js
├── tsconfig.json
├── supabase_setup.sql            # 기본 스키마
└── supabase_setup_with_admin.sql # 관리자 기능 포함 스키마 ★ NEW
```

### 15.11 관리자 기능 문제 해결

#### 문제 1: 관리자 대시보드 접근 시 홈으로 리다이렉트됨

**원인**: 사용자 역할이 'admin'으로 설정되지 않음

**해결**:
```sql
-- 현재 사용자 역할 확인
SELECT ur.role, u.email
FROM user_roles ur
JOIN auth.users u ON ur.user_id = u.id
WHERE u.email = '내이메일@example.com';

-- admin으로 변경
UPDATE user_roles
SET role = 'admin'
WHERE user_id = (SELECT id FROM auth.users WHERE email = '내이메일@example.com');
```

#### 문제 2: user_roles 테이블에 데이터가 없음

**원인**: 신규 사용자 트리거가 작동하지 않음

**해결**:
```sql
-- 트리거 확인
SELECT * FROM pg_trigger WHERE tgname = 'on_auth_user_created';

-- 수동으로 역할 추가
INSERT INTO user_roles (user_id, role)
SELECT id, 'user' FROM auth.users
WHERE id NOT IN (SELECT user_id FROM user_roles);
```

#### 문제 3: RLS 정책 오류로 게시글 수정 불가

**원인**: is_admin 함수가 올바르게 작동하지 않음

**해결**:
```sql
-- is_admin 함수 재생성
DROP FUNCTION IF EXISTS is_admin CASCADE;

CREATE OR REPLACE FUNCTION is_admin(user_uuid UUID)
RETURNS BOOLEAN AS $$
BEGIN
  RETURN EXISTS (
    SELECT 1 FROM user_roles
    WHERE user_id = user_uuid AND role = 'admin'
  );
END;
$$ LANGUAGE plpgsql SECURITY DEFINER;

-- RLS 정책 재생성
DROP POLICY IF EXISTS "Users can update their own posts or admins can update any" ON posts;

CREATE POLICY "Users can update their own posts or admins can update any" ON posts
  FOR UPDATE USING (
    auth.uid() = author_id OR is_admin(auth.uid())
  );
```

---

## 16. 마무리

이 가이드를 따라 프로젝트를 재현하면 다음이 완료됩니다:

- Supabase 데이터베이스 구축
- 이메일 및 Google OAuth 인증 시스템
- 게시판 기능 (CRUD)
- 댓글 시스템
- Row Level Security 보안
- **관리자 권한 시스템** ★ NEW
- **관리자 대시보드** ★ NEW
- Vercel 프로덕션 배포

**완료된 기능**:
- 사용자 인증 (이메일, Google)
- 게시판 (공지사항, 자료실, Q&A)
- 댓글 시스템
- 관리자 역할 기반 권한 관리
- 관리자 전용 대시보드
- RLS 보안 정책

**다음 단계 (선택사항)**:
- UI/UX 개선
- 파일 업로드 기능 구현
- 검색 기능 추가
- 페이지네이션 구현
- 이메일 알림 기능
- 사용자 프로필 페이지

프로젝트에 대한 질문이나 문제가 있으면 Supabase 또는 Next.js 공식 문서를 참고하세요.
